<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Peshawar Lions - Cricket Team Management</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/chart.js@3.7.1/dist/chart.min.css">
    <style>
        :root {
            --primary: #1a365d;
            --secondary: #e53e3e;
            --accent: #f6ad55;
            --light: #f7fafc;
            --dark: #2d3748;
            --success: #38a169;
            --warning: #dd6b20;
            --danger: #e53e3e;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Montserrat', sans-serif;
        }

        body {
            background-color: #f5f5f5;
            color: var(--dark);
        }

        #app-container {
            display: grid;
            grid-template-rows: auto 1fr auto;
            min-height: 100vh;
            max-width: 1200px;
            margin: 0 auto;
            background-color: white;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
        }

        /* Header Styles */
        header {
            background: linear-gradient(135deg, var(--primary), #2c5282);
            color: white;
            padding: 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: relative;
            z-index: 10;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .logo img {
            height: 50px;
            width: auto;
            border-radius: 50%;
            border: 2px solid var(--accent);
        }

        .logo h1 {
            font-size: 1.5rem;
            font-weight: 700;
        }

        /* Navigation */
        nav {
            background-color: white;
            border-bottom: 1px solid #e2e8f0;
            position: sticky;
            top: 0;
            z-index: 5;
        }

        .nav-tabs {
            display: flex;
            list-style: none;
            overflow-x: auto;
            padding: 0 1rem;
            scrollbar-width: none;
        }

        .nav-tabs::-webkit-scrollbar {
            display: none;
        }

        .nav-tabs li {
            padding: 1rem;
            border-bottom: 3px solid transparent;
            white-space: nowrap;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .nav-tabs li:hover {
            color: var(--primary);
        }

        .nav-tabs li.active {
            border-bottom-color: var(--secondary);
            color: var(--primary);
            font-weight: 600;
        }

        /* Main Content */
        main {
            padding: 1.5rem;
            overflow-y: auto;
            background-color: var(--light);
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .section-header h2 {
            color: var(--primary);
            font-size: 1.5rem;
        }

        /* Cards */
        .card {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }

        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background-color: white;
            border-radius: 8px;
            padding: 1.5rem;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            border-top: 4px solid var(--accent);
        }

        .stat-card h3 {
            color: var(--dark);
            font-size: 1rem;
            margin-bottom: 0.5rem;
        }

        .stat-card p {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--primary);
        }

        /* Tables */
        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1rem;
        }

        .data-table th, .data-table td {
            padding: 0.75rem;
            text-align: left;
            border-bottom: 1px solid #e2e8f0;
        }

        .data-table th {
            background-color: var(--primary);
            color: white;
            font-weight: 600;
        }

        .data-table tr:nth-child(even) {
            background-color: #f8fafc;
        }

        .data-table tr:hover {
            background-color: #edf2f7;
        }

        /* Forms */
        .form-group {
            margin-bottom: 1rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
        }

        .form-control {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid #e2e8f0;
            border-radius: 4px;
            font-size: 1rem;
            transition: border-color 0.3s ease;
        }

        .form-control:focus {
            outline: none;
            border-color: var(--primary);
        }

        .btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 4px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-primary {
            background-color: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background-color: #2c5282;
        }

        .btn-secondary {
            background-color: var(--secondary);
            color: white;
        }

        .btn-secondary:hover {
            background-color: #c53030;
        }

        /* Wagon Wheel */
        .wagon-wheel {
            width: 300px;
            height: 300px;
            border-radius: 50%;
            background-color: #f0f4f8;
            position: relative;
            margin: 2rem auto;
        }

        .wagon-wheel .segment {
            position: absolute;
            width: 50%;
            height: 50%;
            transform-origin: 100% 100%;
            left: 0;
            top: 0;
        }

        .wagon-wheel .segment:nth-child(1) { transform: rotate(0deg) skewY(30deg); }
        .wagon-wheel .segment:nth-child(2) { transform: rotate(60deg) skewY(30deg); }
        .wagon-wheel .segment:nth-child(3) { transform: rotate(120deg) skewY(30deg); }
        .wagon-wheel .segment:nth-child(4) { transform: rotate(180deg) skewY(30deg); }
        .wagon-wheel .segment:nth-child(5) { transform: rotate(240deg) skewY(30deg); }
        .wagon-wheel .segment:nth-child(6) { transform: rotate(300deg) skewY(30deg); }

        .wagon-wheel .shot {
            position: absolute;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background-color: var(--secondary);
            transform: translate(-50%, -50%);
        }

        /* Match Scorecard */
        .scorecard {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }

        .scorecard-team {
            padding: 1rem;
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        /* Offline Indicator */
        .offline-indicator {
            position: fixed;
            bottom: 1rem;
            left: 1rem;
            background-color: var(--warning);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            display: none;
            z-index: 1000;
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background-color: white;
            padding: 2rem;
            border-radius: 8px;
            width: 90%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
        }

        /* Footer */
        footer {
            background-color: var(--dark);
            color: white;
            padding: 1rem;
            text-align: center;
            font-size: 0.9rem;
        }

        /* Add Button */
        .add-btn {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            background-color: var(--secondary);
            color: white;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            cursor: pointer;
            z-index: 100;
            transition: all 0.3s ease;
        }

        .add-btn:hover {
            transform: scale(1.1);
            background-color: #c53030;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .logo h1 {
                font-size: 1.2rem;
            }
            
            .nav-tabs li {
                padding: 0.75rem 0.5rem;
                font-size: 0.9rem;
            }
            
            .stats-grid {
                grid-template-columns: 1fr 1fr;
            }

            .scorecard {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 480px) {
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .add-btn {
                width: 50px;
                height: 50px;
                bottom: 1.5rem;
                right: 1.5rem;
            }
        }
    </style>
</head>
<body>
    <div id="app-container">
        <!-- Header -->
        <header>
            <div class="logo">
                <img src="https://i.postimg.cc/zymCWvRc/logo.png" alt="Peshawar Lions Logo">
                <h1>Peshawar Lions</h1>
            </div>
            <div class="auth-section">
                <button id="auth-btn" class="btn-auth">Login</button>
                <div id="user-profile" style="display: none;">
                    <img id="user-avatar" src="" alt="User" class="user-avatar">
                    <span id="user-name"></span>
                </div>
            </div>
        </header>
        
        <!-- Navigation -->
        <nav>
            <ul class="nav-tabs">
                <li class="active" data-section="dashboard"><i class="fas fa-home"></i> Dashboard</li>
                <li data-section="players"><i class="fas fa-users"></i> Players</li>
                <li data-section="matches"><i class="fas fa-calendar-alt"></i> Matches</li>
                <li data-section="tournaments"><i class="fas fa-trophy"></i> Tournaments</li>
                <li data-section="scorekeeper"><i class="fas fa-pencil-alt"></i> Scorekeeper</li>
                <li data-section="analytics"><i class="fas fa-chart-bar"></i> Analytics</li>
                <li data-section="settings"><i class="fas fa-cog"></i> Settings</li>
                <li data-section="admin" id="admin-tab" style="display: none;"><i class="fas fa-lock"></i> Admin</li>
            </ul>
        </nav>
        
        <!-- Main Content -->
        <main>
            <!-- Dashboard Section -->
            <section id="dashboard" class="app-section active">
                <div class="section-header">
                    <h2>Team Dashboard</h2>
                    <div>
                        <button class="btn btn-primary" id="quick-score-btn">Quick Score</button>
                    </div>
                </div>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <h3>Total Matches</h3>
                        <p id="total-matches">0</p>
                    </div>
                    <div class="stat-card">
                        <h3>Matches Won</h3>
                        <p id="matches-won">0</p>
                    </div>
                    <div class="stat-card">
                        <h3>Matches Lost</h3>
                        <p id="matches-lost">0</p>
                    </div>
                    <div class="stat-card">
                        <h3>Win Percentage</h3>
                        <p id="win-percentage">0%</p>
                    </div>
                </div>
                
                <div class="card">
                    <h3>Upcoming Match</h3>
                    <div id="upcoming-match" class="match-info">
                        <div class="scorecard">
                            <div class="scorecard-team">
                                <h4>Peshawar Lions</h4>
                                <p>vs</p>
                                <h4 id="opponent-name">Opponent Team</h4>
                                <p id="match-date">Date: Loading...</p>
                                <p id="match-venue">Venue: Loading...</p>
                            </div>
                            <div class="scorecard-team">
                                <h4>Match Details</h4>
                                <p id="match-format">Format: T20</p>
                                <p id="match-toss">Toss: Not decided</p>
                                <button class="btn btn-secondary" id="start-match-btn">Start Scoring</button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="card">
                    <h3>Recent Performance</h3>
                    <canvas id="performance-chart" height="300"></canvas>
                </div>
            </section>
            
            <!-- Players Section -->
            <section id="players" class="app-section" style="display: none;">
                <div class="section-header">
                    <h2>Player Management</h2>
                    <button class="btn btn-primary" id="add-player-btn">Add Player</button>
                </div>
                
                <div class="card">
                    <div class="table-responsive">
                        <table class="data-table" id="players-table">
                            <thead>
                                <tr>
                                    <th>Photo</th>
                                    <th>Name</th>
                                    <th>Role</th>
                                    <th>Matches</th>
                                    <th>Runs</th>
                                    <th>Wickets</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="players-list">
                                <!-- Players will be loaded here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>
            
            <!-- Matches Section -->
            <section id="matches" class="app-section" style="display: none;">
                <div class="section-header">
                    <h2>Match History</h2>
                    <button class="btn btn-primary" id="add-match-btn">Add Match</button>
                </div>
                
                <div class="card">
                    <div class="table-responsive">
                        <table class="data-table" id="matches-table">
                            <thead>
                                <tr>
                                    <th>Date</th>
                                    <th>Opponent</th>
                                    <th>Format</th>
                                    <th>Result</th>
                                    <th>Score</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="matches-list">
                                <!-- Matches will be loaded here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>
            
            <!-- Tournaments Section -->
            <section id="tournaments" class="app-section" style="display: none;">
                <div class="section-header">
                    <h2>Tournaments</h2>
                    <button class="btn btn-primary" id="create-tournament-btn">Create Tournament</button>
                </div>
                
                <div class="card">
                    <div class="table-responsive">
                        <table class="data-table" id="tournaments-table">
                            <thead>
                                <tr>
                                    <th>Name</th>
                                    <th>Teams</th>
                                    <th>Start Date</th>
                                    <th>End Date</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="tournaments-list">
                                <!-- Tournaments will be loaded here -->
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <div class="card" id="points-table-container" style="display: none;">
                    <h3>Points Table</h3>
                    <div class="table-responsive">
                        <table class="data-table" id="points-table">
                            <!-- Points table will be generated here -->
                        </table>
                    </div>
                </div>
            </section>
            
            <!-- Scorekeeper Section -->
            <section id="scorekeeper" class="app-section" style="display: none;">
                <div class="section-header">
                    <h2>Live Scorekeeper</h2>
                    <div>
                        <button class="btn btn-secondary" id="end-innings-btn">End Innings</button>
                        <button class="btn btn-danger" id="finish-match-btn">Finish Match</button>
                    </div>
                </div>
                
                <div class="card">
                    <div class="scorecard">
                        <div class="scorecard-team" id="batting-team">
                            <h4>Batting Team</h4>
                            <p id="batting-score">0/0 (0.0 overs)</p>
                            <div id="current-batsmen">
                                <!-- Batsmen will be shown here -->
                            </div>
                        </div>
                        <div class="scorecard-team" id="bowling-team">
                            <h4>Bowling Team</h4>
                            <p id="bowling-stats">0 wickets, 0 runs</p>
                            <div id="current-bowler">
                                <!-- Bowler will be shown here -->
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="card">
                    <h3>Score Input</h3>
                    <div class="stats-grid">
                        <button class="stat-card" id="score-1">1</button>
                        <button class="stat-card" id="score-2">2</button>
                        <button class="stat-card" id="score-3">3</button>
                        <button class="stat-card" id="score-4">4</button>
                        <button class="stat-card" id="score-5">5</button>
                        <button class="stat-card" id="score-6">6</button>
                        <button class="stat-card" id="score-w">W</button>
                        <button class="stat-card" id="score-wd">WD</button>
                        <button class="stat-card" id="score-nb">NB</button>
                        <button class="stat-card" id="score-b">B</button>
                        <button class="stat-card" id="score-lb">LB</button>
                        <button class="stat-card" id="score-dot">.</button>
                    </div>
                </div>
                
                <div class="card">
                    <h3>Wagon Wheel</h3>
                    <div class="wagon-wheel" id="wagon-wheel">
                        <!-- Wagon wheel will be rendered here -->
                    </div>
                </div>
            </section>
            
            <!-- Analytics Section -->
            <section id="analytics" class="app-section" style="display: none;">
                <div class="section-header">
                    <h2>Team Analytics</h2>
                    <div>
                        <select class="form-control" id="analytics-period">
                            <option value="7">Last 7 Days</option>
                            <option value="30">Last 30 Days</option>
                            <option value="90">Last 90 Days</option>
                            <option value="all">All Time</option>
                        </select>
                    </div>
                </div>
                
                <div class="card">
                    <h3>Batting Performance</h3>
                    <canvas id="batting-chart" height="300"></canvas>
                </div>
                
                <div class="card">
                    <h3>Bowling Performance</h3>
                    <canvas id="bowling-chart" height="300"></canvas>
                </div>
                
                <div class="card">
                    <h3>Player Comparisons</h3>
                    <div class="stats-grid">
                        <div class="stat-card">
                            <h3>Top Run Scorer</h3>
                            <p id="top-scorer">-</p>
                        </div>
                        <div class="stat-card">
                            <h3>Most Wickets</h3>
                            <p id="top-wicket-taker">-</p>
                        </div>
                        <div class="stat-card">
                            <h3>Best Strike Rate</h3>
                            <p id="best-strike-rate">-</p>
                        </div>
                        <div class="stat-card">
                            <h3>Best Economy</h3>
                            <p id="best-economy">-</p>
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- Settings Section -->
            <section id="settings" class="app-section" style="display: none;">
                <div class="section-header">
                    <h2>Team Settings</h2>
                </div>
                
                <div class="card">
                    <h3>Team Information</h3>
                    <form id="team-settings-form">
                        <div class="form-group">
                            <label for="team-name">Team Name</label>
                            <input type="text" class="form-control" id="team-name" value="Peshawar Lions">
                        </div>
                        <div class="form-group">
                            <label for="team-logo">Team Logo</label>
                            <input type="file" class="form-control" id="team-logo">
                        </div>
                        <div class="form-group">
                            <label for="default-format">Default Match Format</label>
                            <select class="form-control" id="default-format">
                                <option value="t20">T20</option>
                                <option value="odi">ODI</option>
                                <option value="test">Test</option>
                            </select>
                        </div>
                        <button type="submit" class="btn btn-primary">Save Settings</button>
                    </form>
                </div>
                
                <div class="card">
                    <h3>Data Management</h3>
                    <div class="stats-grid">
                        <button class="stat-card" id="backup-data-btn">
                            <i class="fas fa-cloud-upload-alt"></i>
                            <h3>Backup to Cloud</h3>
                        </button>
                        <button class="stat-card" id="restore-data-btn">
                            <i class="fas fa-cloud-download-alt"></i>
                            <h3>Restore from Cloud</h3>
                        </button>
                        <button class="stat-card" id="export-data-btn">
                            <i class="fas fa-file-export"></i>
                            <h3>Export Data</h3>
                        </button>
                        <button class="stat-card" id="import-data-btn">
                            <i class="fas fa-file-import"></i>
                            <h3>Import Data</h3>
                        </button>
                    </div>
                </div>
            </section>
        </main>
        
        <!-- Offline Indicator -->
        <div class="offline-indicator" id="offline-indicator">
            <i class="fas fa-wifi"></i> You are currently offline. Changes will be synced when you reconnect.
        </div>
        
        <!-- Footer -->
        <footer>
            <p>© 2023 Peshawar Lions Cricket Club. All rights reserved.</p>
        </footer>
        
        <!-- Floating Action Button -->
        <div class="add-btn" id="global-add-btn">
            <i class="fas fa-plus"></i>
        </div>
        
        <!-- Add Player Modal -->
        <div class="modal" id="add-player-modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Add New Player</h3>
                    <button class="modal-close" id="close-player-modal">&times;</button>
                </div>
                <form id="player-form">
                    <div class="form-group">
                        <label for="player-name">Full Name</label>
                        <input type="text" class="form-control" id="player-name" required>
                    </div>
                    <div class="form-group">
                        <label for="player-role">Primary Role</label>
                        <select class="form-control" id="player-role" required>
                            <option value="batsman">Batsman</option>
                            <option value="bowler">Bowler</option>
                            <option value="all-rounder">All Rounder</option>
                            <option value="wicketkeeper">Wicketkeeper</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="player-batting">Batting Style</label>
                        <select class="form-control" id="player-batting">
                            <option value="right">Right Handed</option>
                            <option value="left">Left Handed</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="player-bowling">Bowling Style</label>
                        <select class="form-control" id="player-bowling">
                            <option value="right-arm-fast">Right Arm Fast</option>
                            <option value="left-arm-fast">Left Arm Fast</option>
                            <option value="right-arm-spin">Right Arm Spin</option>
                            <option value="left-arm-spin">Left Arm Spin</option>
                            <option value="none">Does Not Bowl</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="player-dob">Date of Birth</label>
                        <input type="date" class="form-control" id="player-dob">
                    </div>
                    <div class="form-group">
                        <label for="player-photo">Player Photo</label>
                        <input type="file" class="form-control" id="player-photo">
                    </div>
                    <button type="submit" class="btn btn-primary">Add Player</button>
                </form>
            </div>
        </div>
        
        <!-- Add Match Modal -->
        <div class="modal" id="add-match-modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Add New Match</h3>
                    <button class="modal-close" id="close-match-modal">&times;</button>
                </div>
                <form id="match-form">
                    <div class="form-group">
                        <label for="match-opponent">Opponent Team</label>
                        <input type="text" class="form-control" id="match-opponent" required>
                    </div>
                    <div class="form-group">
                        <label for="match-date">Match Date</label>
                        <input type="date" class="form-control" id="match-date" required>
                    </div>
                    <div class="form-group">
                        <label for="match-venue">Venue</label>
                        <input type="text" class="form-control" id="match-venue" required>
                    </div>
                    <div class="form-group">
                        <label for="match-format">Match Format</label>
                        <select class="form-control" id="match-format" required>
                            <option value="t20">T20</option>
                            <option value="odi">ODI (50 overs)</option>
                            <option value="test">Test Match</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="match-overs">Overs per Innings</label>
                        <input type="number" class="form-control" id="match-overs" min="1" max="50" value="20">
                    </div>
                    <button type="submit" class="btn btn-primary">Create Match</button>
                </form>
            </div>
        </div>
        
        <!-- Create Tournament Modal -->
        <div class="modal" id="create-tournament-modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Create New Tournament</h3>
                    <button class="modal-close" id="close-tournament-modal">&times;</button>
                </div>
                <form id="tournament-form">
                    <div class="form-group">
                        <label for="tournament-name">Tournament Name</label>
                        <input type="text" class="form-control" id="tournament-name" required>
                    </div>
                    <div class="form-group">
                        <label for="tournament-teams">Number of Teams</label>
                        <input type="number" class="form-control" id="tournament-teams" min="2" max="16" value="4" required>
                    </div>
                    <div class="form-group">
                        <label for="tournament-start">Start Date</label>
                        <input type="date" class="form-control" id="tournament-start" required>
                    </div>
                    <div class="form-group">
                        <label for="tournament-end">End Date</label>
                        <input type="date" class="form-control" id="tournament-end" required>
                    </div>
                    <div class="form-group">
                        <label for="tournament-format">Tournament Format</label>
                        <select class="form-control" id="tournament-format" required>
                            <option value="round-robin">Round Robin</option>
                            <option value="knockout">Knockout</option>
                            <option value="group-knockout">Group + Knockout</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="tournament-match-format">Match Format</label>
                        <select class="form-control" id="tournament-match-format" required>
                            <option value="t20">T20</option>
                            <option value="odi">ODI (50 overs)</option>
                        </select>
                    </div>
                    <button type="submit" class="btn btn-primary">Create Tournament</button>
                </form>
            </div>
        </div>
    </div>

    <!-- Firebase and App Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.7.1/dist/chart.min.js"></script>
    <script type="module">
        // Import Firebase services
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getAnalytics } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-analytics.js";
        import { 
            getAuth, 
            GoogleAuthProvider, 
            signInWithPopup, 
            signOut,
            onAuthStateChanged
        } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
        import { 
            getFirestore, 
            collection, 
            getDocs,
            doc,
            setDoc,
            addDoc,
            updateDoc,
            deleteDoc,
            onSnapshot,
            enableIndexedDbPersistence
        } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";
        import { 
            getStorage,
            ref,
            uploadBytes,
            getDownloadURL
        } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-storage.js";

        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyDDA3oighdyQuuoauoNDYdBUMbFx6yKYTc",
            authDomain: "plapp-e9737.firebaseapp.com",
            projectId: "plapp-e9737",
            storageBucket: "plapp-e9737.appspot.com",
            messagingSenderId: "674359231540",
            appId: "1:674359231540:web:20be424163e48d63c37661",
            measurementId: "G-19DDLP62P0"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const analytics = getAnalytics(app);
        const auth = getAuth(app);
        const db = getFirestore(app);
        const storage = getStorage(app);
        const googleProvider = new GoogleAuthProvider();

        // Enable offline persistence
        enableIndexedDbPersistence(db)
            .catch((err) => {
                if (err.code == 'failed-precondition') {
                    console.log("Offline persistence can only be enabled in one tab at a time.");
                } else if (err.code == 'unimplemented') {
                    console.log("The current browser does not support offline persistence.");
                }
            });

        // Initialize UI
        document.addEventListener('DOMContentLoaded', () => {
            // Check online status
            window.addEventListener('online', updateOnlineStatus);
            window.addEventListener('offline', updateOnlineStatus);
            
            function updateOnlineStatus() {
                const offlineIndicator = document.getElementById('offline-indicator');
                if (navigator.onLine) {
                    offlineIndicator.style.display = 'none';
                } else {
                    offlineIndicator.style.display = 'block';
                }
            }
            
            updateOnlineStatus();

            // Initialize charts
            const performanceCtx = document.getElementById('performance-chart').getContext('2d');
            const performanceChart = new Chart(performanceCtx, {
                type: 'line',
                data: {
                    labels: ['Match 1', 'Match 2', 'Match 3', 'Match 4', 'Match 5', 'Match 6'],
                    datasets: [{
                        label: 'Runs Scored',
                        data: [120, 190, 150, 210, 180, 220],
                        borderColor: 'rgba(75, 192, 192, 1)',
                        backgroundColor: 'rgba(75, 192, 192, 0.2)',
                        tension: 0.1
                    }, {
                        label: 'Wickets Taken',
                        data: [5, 7, 3, 8, 6, 4],
                        borderColor: 'rgba(255, 99, 132, 1)',
                        backgroundColor: 'rgba(255, 99, 132, 0.2)',
                        tension: 0.1
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'top',
                        }
                    }
                }
            });

            const battingCtx = document.getElementById('batting-chart').getContext('2d');
            const battingChart = new Chart(battingCtx, {
                type: 'bar',
                data: {
                    labels: ['Player 1', 'Player 2', 'Player 3', 'Player 4', 'Player 5'],
                    datasets: [{
                        label: 'Runs',
                        data: [320, 290, 250, 210, 180],
                        backgroundColor: 'rgba(54, 162, 235, 0.5)',
                        borderColor: 'rgba(54, 162, 235, 1)',
                        borderWidth: 1
                    }, {
                        label: 'Average',
                        data: [32, 29, 25, 21, 18],
                        backgroundColor: 'rgba(255, 159, 64, 0.5)',
                        borderColor: 'rgba(255, 159, 64, 1)',
                        borderWidth: 1,
                        type: 'line'
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'top',
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });

            const bowlingCtx = document.getElementById('bowling-chart').getContext('2d');
            const bowlingChart = new Chart(bowlingCtx, {
                type: 'bar',
                data: {
                    labels: ['Player 1', 'Player 2', 'Player 3', 'Player 4', 'Player 5'],
                    datasets: [{
                        label: 'Wickets',
                        data: [12, 9, 8, 6, 5],
                        backgroundColor: 'rgba(255, 99, 132, 0.5)',
                        borderColor: 'rgba(255, 99, 132, 1)',
                        borderWidth: 1
                    }, {
                        label: 'Economy',
                        data: [5.2, 6.1, 4.8, 7.2, 5.9],
                        backgroundColor: 'rgba(153, 102, 255, 0.5)',
                        borderColor: 'rgba(153, 102, 255, 1)',
                        borderWidth: 1,
                        type: 'line'
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'top',
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });

            // Initialize wagon wheel
            const wagonWheel = document.getElementById('wagon-wheel');
            for (let i = 0; i < 6; i++) {
                const segment = document.createElement('div');
                segment.className = 'segment';
                wagonWheel.appendChild(segment);
            }

            // Add sample shots to wagon wheel
            for (let i = 0; i < 20; i++) {
                const shot = document.createElement('div');
                shot.className = 'shot';
                shot.style.left = `${Math.random() * 100}%`;
                shot.style.top = `${Math.random() * 100}%`;
                wagonWheel.appendChild(shot);
            }

            // Auth state observer
            onAuthStateChanged(auth, (user) => {
                if (user) {
                    // User is signed in
                    document.getElementById('auth-btn').style.display = 'none';
                    const userProfile = document.getElementById('user-profile');
                    userProfile.style.display = 'flex';
                    document.getElementById('user-name').textContent = user.displayName || user.email;
                    
                    // Set admin tab visibility based on user role
                    if (user.uid === 'ADMIN_UID_HERE') { // Replace with your admin check
                        document.getElementById('admin-tab').style.display = 'list-item';
                    }
                    
                    // Load initial data
                    loadPlayers();
                    loadMatches();
                    loadTournaments();
                } else {
                    // User is signed out
                    document.getElementById('auth-btn').style.display = 'block';
                    document.getElementById('user-profile').style.display = 'none';
                }
            });

            // Auth button click handler
            document.getElementById('auth-btn').addEventListener('click', () => {
                signInWithPopup(auth, googleProvider)
                    .catch((error) => {
                        console.error('Authentication error:', error);
                    });
            });

            // Navigation click handlers
            document.querySelectorAll('.nav-tabs li').forEach(tab => {
                tab.addEventListener('click', () => {
                    // Remove active class from all tabs and hide all sections
                    document.querySelectorAll('.nav-tabs li').forEach(t => t.classList.remove('active'));
                    document.querySelectorAll('.app-section').forEach(s => s.style.display = 'none');
                    
                    // Add active class to clicked tab and show corresponding section
                    tab.classList.add('active');
                    document.getElementById(tab.dataset.section).style.display = 'block';
                });
            });

            // Add button click handler
            document.getElementById('global-add-btn').addEventListener('click', () => {
                const activeSection = document.querySelector('.nav-tabs li.active').dataset.section;
                showAddDialog(activeSection);
            });

            // Modal handlers
            document.getElementById('add-player-btn').addEventListener('click', () => {
                document.getElementById('add-player-modal').style.display = 'flex';
            });

            document.getElementById('close-player-modal').addEventListener('click', () => {
                document.getElementById('add-player-modal').style.display = 'none';
            });

            document.getElementById('add-match-btn').addEventListener('click', () => {
                document.getElementById('add-match-modal').style.display = 'flex';
            });

            document.getElementById('close-match-modal').addEventListener('click', () => {
                document.getElementById('add-match-modal').style.display = 'none';
            });

            document.getElementById('create-tournament-btn').addEventListener('click', () => {
                document.getElementById('create-tournament-modal').style.display = 'flex';
            });

            document.getElementById('close-tournament-modal').addEventListener('click', () => {
                document.getElementById('create-tournament-modal').style.display = 'none';
            });

            // Close modals when clicking outside
            window.addEventListener('click', (e) => {
                if (e.target.classList.contains('modal')) {
                    e.target.style.display = 'none';
                }
            });

            // Form submissions
            document.getElementById('player-form').addEventListener('submit', (e) => {
                e.preventDefault();
                addPlayer();
            });

            document.getElementById('match-form').addEventListener('submit', (e) => {
                e.preventDefault();
                addMatch();
            });

            document.getElementById('tournament-form').addEventListener('submit', (e) => {
                e.preventDefault();
                createTournament();
            });

            // Score input buttons
            document.querySelectorAll('.stat-card[id^="score-"]').forEach(btn => {
                btn.addEventListener('click', () => {
                    const scoreType = btn.id.split('-')[1];
                    recordScore(scoreType);
                });
            });
        });

        // Data loading functions
        function loadPlayers() {
            const playersList = document.getElementById('players-list');
            playersList.innerHTML = '<tr><td colspan="7">Loading players...</td></tr>';
            
            getDocs(collection(db, 'players'))
                .then((querySnapshot) => {
                    playersList.innerHTML = '';
                    
                    if (querySnapshot.empty) {
                        playersList.innerHTML = '<tr><td colspan="7">No players found. Add your first player!</td></tr>';
                        return;
                    }
                    
                    querySnapshot.forEach((doc) => {
                        const player = doc.data();
                        const row = document.createElement('tr');
                        row.innerHTML = `
                            <td><img src="${player.photoUrl || 'https://via.placeholder.com/50'}" alt="${player.name}" width="50" height="50" style="border-radius: 50%;"></td>
                            <td>${player.name}</td>
                            <td>${player.role}</td>
                            <td>${player.matches || 0}</td>
                            <td>${player.runs || 0}</td>
                            <td>${player.wickets || 0}</td>
                            <td>
                                <button class="btn btn-primary btn-sm">View</button>
                                <button class="btn btn-secondary btn-sm">Edit</button>
                            </td>
                        `;
                        playersList.appendChild(row);
                    });
                })
                .catch((error) => {
                    console.error('Error loading players:', error);
                    playersList.innerHTML = '<tr><td colspan="7">Error loading players. Please try again.</td></tr>';
                });
        }

        function loadMatches() {
            const matchesList = document.getElementById('matches-list');
            matchesList.innerHTML = '<tr><td colspan="6">Loading matches...</td></tr>';
            
            getDocs(collection(db, 'matches'))
                .then((querySnapshot) => {
                    matchesList.innerHTML = '';
                    
                    if (querySnapshot.empty) {
                        matchesList.innerHTML = '<tr><td colspan="6">No matches found. Add your first match!</td></tr>';
                        return;
                    }
                    
                    querySnapshot.forEach((doc) => {
                        const match = doc.data();
                        const row = document.createElement('tr');
                        row.innerHTML = `
                            <td>${new Date(match.date).toLocaleDateString()}</td>
                            <td>${match.opponent}</td>
                            <td>${match.format.toUpperCase()}</td>
                            <td>${match.result || 'Not played yet'}</td>
                            <td>${match.score || '-'}</td>
                            <td>
                                <button class="btn btn-primary btn-sm">View</button>
                                <button class="btn btn-secondary btn-sm">Score</button>
                            </td>
                        `;
                        matchesList.appendChild(row);
                    });
                })
                .catch((error) => {
                    console.error('Error loading matches:', error);
                    matchesList.innerHTML = '<tr><td colspan="6">Error loading matches. Please try again.</td></tr>';
                });
        }

        function loadTournaments() {
            const tournamentsList = document.getElementById('tournaments-list');
            tournamentsList.innerHTML = '<tr><td colspan="6">Loading tournaments...</td></tr>';
            
            getDocs(collection(db, 'tournaments'))
                .then((querySnapshot) => {
                    tournamentsList.innerHTML = '';
                    
                    if (querySnapshot.empty) {
                        tournamentsList.innerHTML = '<tr><td colspan="6">No tournaments found. Create your first tournament!</td></tr>';
                        return;
                    }
                    
                    querySnapshot.forEach((doc) => {
                        const tournament = doc.data();
                        const row = document.createElement('tr');
                        row.innerHTML = `
                            <td>${tournament.name}</td>
                            <td>${tournament.teams}</td>
                            <td>${new Date(tournament.startDate).toLocaleDateString()}</td>
                            <td>${new Date(tournament.endDate).toLocaleDateString()}</td>
                            <td>${getTournamentStatus(tournament)}</td>
                            <td>
                                <button class="btn btn-primary btn-sm">View</button>
                                <button class="btn btn-secondary btn-sm">Manage</button>
                            </td>
                        `;
                        tournamentsList.appendChild(row);
                    });
                })
                .catch((error) => {
                    console.error('Error loading tournaments:', error);
                    tournamentsList.innerHTML = '<tr><td colspan="6">Error loading tournaments. Please try again.</td></tr>';
                });
        }

        function getTournamentStatus(tournament) {
            const today = new Date();
            const startDate = new Date(tournament.startDate);
            const endDate = new Date(tournament.endDate);
            
            if (today < startDate) {
                return 'Upcoming';
            } else if (today > endDate) {
                return 'Completed';
            } else {
                return 'In Progress';
            }
        }

        // Data creation functions
        function addPlayer() {
            const form = document.getElementById('player-form');
            const playerName = document.getElementById('player-name').value;
            const playerRole = document.getElementById('player-role').value;
            const playerBatting = document.getElementById('player-batting').value;
            const playerBowling = document.getElementById('player-bowling').value;
            const playerDob = document.getElementById('player-dob').value;
            const playerPhoto = document.getElementById('player-photo').files[0];
            
            // Create player data object
            const playerData = {
                name: playerName,
                role: playerRole,
                battingStyle: playerBatting,
                bowlingStyle: playerBowling,
                dob: playerDob,
                createdAt: new Date().toISOString(),
                matches: 0,
                runs: 0,
                wickets: 0
            };
            
            // First upload photo if selected
            if (playerPhoto) {
                const storageRef = ref(storage, `players/${playerName}-${Date.now()}`);
                uploadBytes(storageRef, playerPhoto)
                    .then((snapshot) => {
                        return getDownloadURL(snapshot.ref);
                    })
                    .then((downloadURL) => {
                        playerData.photoUrl = downloadURL;
                        return addDoc(collection(db, 'players'), playerData);
                    })
                    .then(() => {
                        alert('Player added successfully!');
                        form.reset();
                        document.getElementById('add-player-modal').style.display = 'none';
                        loadPlayers();
                    })
                    .catch((error) => {
                        console.error('Error adding player:', error);
                        alert('Error adding player. Please try again.');
                    });
            } else {
                addDoc(collection(db, 'players'), playerData)
                    .then(() => {
                        alert('Player added successfully!');
                        form.reset();
                        document.getElementById('add-player-modal').style.display = 'none';
                        loadPlayers();
                    })
                    .catch((error) => {
                        console.error('Error adding player:', error);
                        alert('Error adding player. Please try again.');
                    });
            }
        }

        function addMatch() {
            const form = document.getElementById('match-form');
            const opponent = document.getElementById('match-opponent').value;
            const date = document.getElementById('match-date').value;
            const venue = document.getElementById('match-venue').value;
            const format = document.getElementById('match-format').value;
            const overs = document.getElementById('match-overs').value;
            
            const matchData = {
                opponent,
                date,
                venue,
                format,
                overs: parseInt(overs),
                createdAt: new Date().toISOString(),
                status: 'scheduled',
                toss: null,
                result: null,
                score: null
            };
            
            addDoc(collection(db, 'matches'), matchData)
                .then(() => {
                    alert('Match added successfully!');
                    form.reset();
                    document.getElementById('add-match-modal').style.display = 'none';
                    loadMatches();
                })
                .catch((error) => {
                    console.error('Error adding match:', error);
                    alert('Error adding match. Please try again.');
                });
        }

        function createTournament() {
            const form = document.getElementById('tournament-form');
            const name = document.getElementById('tournament-name').value;
            const teams = document.getElementById('tournament-teams').value;
            const startDate = document.getElementById('tournament-start').value;
            const endDate = document.getElementById('tournament-end').value;
            const format = document.getElementById('tournament-format').value;
            const matchFormat = document.getElementById('tournament-match-format').value;
            
            const tournamentData = {
                name,
                teams: parseInt(teams),
                startDate,
                endDate,
                format,
                matchFormat,
                createdAt: new Date().toISOString(),
                status: 'planned',
                currentStage: 'group',
                fixturesGenerated: false
            };
            
            addDoc(collection(db, 'tournaments'), tournamentData)
                .then(() => {
                    alert('Tournament created successfully!');
                    form.reset();
                    document.getElementById('create-tournament-modal').style.display = 'none';
                    loadTournaments();
                })
                .catch((error) => {
                    console.error('Error creating tournament:', error);
                    alert('Error creating tournament. Please try again.');
                });
        }

        // Scorekeeping functions
        function recordScore(scoreType) {
            // This would be more complex in a real implementation
            console.log(`Recording score: ${scoreType}`);
            
            // Update UI to reflect the score
            // In a real app, this would update the match state in Firestore
            const battingScore = document.getElementById('batting-score');
            const currentScore = battingScore.textContent.split(' ')[0].split('/');
            let runs = parseInt(currentScore[0]);
            let wickets = parseInt(currentScore[1]);
            
            switch(scoreType) {
                case '1': runs += 1; break;
                case '2': runs += 2; break;
                case '3': runs += 3; break;
                case '4': runs += 4; break;
                case '5': runs += 5; break;
                case '6': runs += 6; break;
                case 'w': wickets += 1; break;
                case 'wd': runs += 1; break;
                case 'nb': runs += 1; break;
                // Other score types would be handled here
            }
            
            battingScore.textContent = `${runs}/${wickets} (0.0 overs)`;
            
            // Add a shot to the wagon wheel for scoring shots
            if (['1','2','3','4','5','6'].includes(scoreType)) {
                const wagonWheel = document.getElementById('wagon-wheel');
                const shot = document.createElement('div');
                shot.className = 'shot';
                shot.style.left = `${Math.random() * 100}%`;
                shot.style.top = `${Math.random() * 100}%`;
                wagonWheel.appendChild(shot);
            }
        }

        // Helper functions
        function showAddDialog(section) {
            switch(section) {
                case 'players':
                    document.getElementById('add-player-modal').style.display = 'flex';
                    break;
                case 'matches':
                    document.getElementById('add-match-modal').style.display = 'flex';
                    break;
                case 'tournaments':
                    document.getElementById('create-tournament-modal').style.display = 'flex';
                    break;
                default:
                    alert(`Add functionality for ${section} section`);
            }
        }
    </script>
</body>
</html>
<script>
// Simple Scoring System (add this as a new file or at bottom)
let score = { runs: 0, wickets: 0, balls: 0 };

function updateScore(button) {
  const type = button.id.split('-')[1];
  
  if (type === '1') score.runs += 1;
  if (type === '2') score.runs += 2;
  // Add other cases...
  
  if (type !== 'wd' && type !== 'nb') score.balls++;
  
  document.getElementById('batting-score').textContent = 
    `${score.runs}/${score.wickets} (${Math.floor(score.balls/6)}.${score.balls%6})`;
}

// Connect buttons
document.querySelectorAll('[id^="score-"]').forEach(btn => {
  btn.onclick = () => updateScore(btn);
});
</script>
